---
import { changeLanguage } from "i18next";
import BaseLayout from "templates:BaseLayout";

changeLanguage("en");

const { url } = Astro;
const processId = Astro.params.id;
const res = await fetch(`${url.origin}/api/quick/process/${processId}`, { method: "GET" });
const data = await res.json();
const quick = JSON.parse(data.process);
const proposalTime = +new Date(quick.proposalEnd) - +new Date();
const votingTime = +new Date(quick.votingEnd) - +new Date();
if (!quick) {
    return Astro.redirect("/quick");
}
if (proposalTime > 0) {
    return Astro.redirect(`${url.origin}/api/quick/${processId}/proposals`);
}
else if (votingTime > 0) {
    return Astro.redirect(`${url.origin}/api/quick/${processId}/voting`);
}
else {
    return Astro.redirect(`${url.origin}/api/quick/${processId}/results`);
}
---

<BaseLayout>

</BaseLayout>

