---
import { changeLanguage } from "i18next";
import BaseLayout from "templates:BaseLayout";

changeLanguage("de");

const { url } = Astro;
const processId = Astro.params.id;
const res = await fetch(`${url.origin}/api/quick/process/${processId}`, { method: "GET" });
const data = await res.json();
const quick = JSON.parse(data.process);
const proposalTime = +new Date(quick.proposalEnd) - +new Date();
const votingTime = +new Date(quick.votingEnd) - +new Date();
switch(true) {
  case !quick:
    return Astro.redirect("/quick");
  case proposalTime > 0:
    return Astro.redirect(`${url.origin}/api/quick/${processId}/proposals`);
  case votingTime > 0:
    return Astro.redirect(`${url.origin}/api/quick/${processId}/voting`);
  default:
    return Astro.redirect(`${url.origin}/api/quick/${processId}/results`);
}
---

<BaseLayout>

</BaseLayout>

